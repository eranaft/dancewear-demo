<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dancewear Demo</title>
  <style>
    :root { --bg:#0b0b0c; --card:#141417; --text:#f2f2f3; --muted:#a7a7ad; --accent:#7c5cff; }
    body { margin:0; font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial; background:var(--bg); color:var(--text); }
    header { padding:16px 16px 8px; position:sticky; top:0; background:linear-gradient(#0b0b0c, rgba(11,11,12,.7)); backdrop-filter: blur(6px); }
    .row { display:flex; gap:10px; align-items:center; }
    .title { font-size:18px; font-weight:700; }
    .pill { margin-left:auto; background:var(--card); padding:8px 10px; border-radius:999px; font-size:13px; color:var(--muted); }
    main { padding:12px 16px 90px; }
    .grid { display:grid; grid-template-columns: 1fr; gap:10px; }
    .card { background:var(--card); border-radius:16px; padding:12px; }
    .card h3 { margin:0 0 6px; font-size:16px; }
    .muted { color:var(--muted); font-size:13px; }
    .price { font-size:16px; font-weight:700; margin-top:10px; }
    button { width:100%; margin-top:10px; border:0; border-radius:12px; padding:12px; font-weight:700; cursor:pointer; }
    .btn { background:var(--accent); color:white; }
    .btn2 { background:#232329; color:var(--text); }
    .bar { position:fixed; left:0; right:0; bottom:0; padding:12px 16px; background:rgba(11,11,12,.85); backdrop-filter: blur(10px); border-top:1px solid rgba(255,255,255,.06); }
    input, textarea { width:100%; box-sizing:border-box; border-radius:12px; border:1px solid rgba(255,255,255,.10); padding:12px; background:#0f0f12; color:var(--text); }
    textarea { min-height:80px; resize:vertical; }
    .two { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    a { color: var(--accent); }
  </style>
</head>

<body>
<header>
  <div class="row">
    <div class="title">Dancewear ‚Ä¢ Demo</div>
    <div class="pill" id="cartPill">–ö–æ—Ä–∑–∏–Ω–∞: 0</div>
  </div>
  <div class="muted" style="margin-top:6px;">–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –≤–Ω—É—Ç—Ä–∏ Telegram (–¥–µ–º–æ –±–µ–∑ –æ–ø–ª–∞—Ç—ã)</div>
</header>

<main>
  <div id="viewCatalog">
    <div class="grid" id="catalog"></div>
  </div>

  <div id="viewCart" style="display:none;">
    <div class="card">
      <h3>–ö–æ—Ä–∑–∏–Ω–∞</h3>
      <div class="muted" id="cartList"></div>
      <div class="price" id="cartTotal"></div>
      <button class="btn2" onclick="goCatalog()">‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</button>
    </div>

    <div class="card" style="margin-top:10px;">
      <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ (–¥–µ–º–æ)</h3>
      <div class="two">
        <div>
          <div class="muted" style="margin:6px 0;">–ò–º—è</div>
          <input id="name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∞—à–∞" />
        </div>
        <div>
          <div class="muted" style="margin:6px 0;">–¢–µ–ª–µ—Ñ–æ–Ω</div>
          <input id="phone" placeholder="+7 ..." />
        </div>
      </div>
      <div class="muted" style="margin:10px 0 6px;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (—Ä–∞–∑–º–µ—Ä/—Ü–≤–µ—Ç/–¥–æ—Å—Ç–∞–≤–∫–∞)</div>
      <textarea id="comment" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ä–∞–∑–º–µ—Ä M, –¥–æ—Å—Ç–∞–≤–∫–∞ –°–î–≠–ö"></textarea>

      <button class="btn" onclick="sendOrder()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑ –≤ Telegram</button>
      <div class="muted" style="margin-top:10px;">
        * –í –¥–µ–º–æ –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞. –ü–æ—Å–ª–µ ‚Äú–û–ö‚Äù –∑–∞–∫–∞–∑ —É–ª–µ—Ç–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ–º –≤–ª–∞–¥–µ–ª—å—Ü—É.
      </div>
    </div>
  </div>
</main>

<div class="bar">
  <button class="btn" id="mainBtn" onclick="goCart()">–û—Ç–∫—Ä—ã—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
</div>

<script>
  // 1) –§–µ–π–∫–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã (–ø–æ—Ç–æ–º –∑–∞–º–µ–Ω–∏–º –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ)
  const PRODUCTS = [
    { id:"set1", name:"–ö–æ–º–ø–ª–µ–∫—Ç 'Neon Flow'", desc:"–¢–æ–ø + –ª–µ–≥–∏–Ω—Å—ã ‚Ä¢ 3 —Ü–≤–µ—Ç–∞", price: 3490 },
    { id:"leo1", name:"–ö—É–ø–∞–ª—å–Ω–∏–∫ 'Stage'", desc:"–°–µ—Ç—á–∞—Ç–∞—è –≤—Å—Ç–∞–≤–∫–∞ ‚Ä¢ XS‚ÄìL", price: 2590 },
    { id:"top1", name:"–¢–æ–ø 'Pulse'", desc:"–ü–æ–¥–¥–µ—Ä–∂–∫–∞ ‚Ä¢ —á–∞—à–∫–∏", price: 1490 },
    { id:"leg1", name:"–õ–µ–≥–∏–Ω—Å—ã 'High Rise'", desc:"–í—ã—Å–æ–∫–∞—è –ø–æ—Å–∞–¥–∫–∞ ‚Ä¢ –ø–ª–æ—Ç–Ω—ã–µ", price: 1990 }
  ];

  // 2) –ö–æ—Ä–∑–∏–Ω–∞ –≤ localStorage
  const CART_KEY = "demo_cart_v1";
  function getCart(){ return JSON.parse(localStorage.getItem(CART_KEY) || "{}"); }
  function setCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); updateUI(); }

  function addToCart(id){
    const c = getCart();
    c[id] = (c[id] || 0) + 1;
    setCart(c);
  }
  function removeFromCart(id){
    const c = getCart();
    if (!c[id]) return;
    c[id] -= 1;
    if (c[id] <= 0) delete c[id];
    setCart(c);
  }

  function cartCount(){
    const c = getCart();
    return Object.values(c).reduce((a,b)=>a+b,0);
  }

  function cartSummary(){
    const c = getCart();
    let lines = [];
    let total = 0;
    for (const [id, qty] of Object.entries(c)){
      const p = PRODUCTS.find(x=>x.id===id);
      if (!p) continue;
      total += p.price * qty;
      lines.push(`${p.name} √ó ${qty} = ${p.price*qty}‚ÇΩ`);
    }
    return { lines, total };
  }

  // 3) –†–µ–Ω–¥–µ—Ä
  function renderCatalog(){
    const el = document.getElementById("catalog");
    el.innerHTML = "";
    PRODUCTS.forEach(p=>{
      const card = document.createElement("div");
      card.className="card";
      card.innerHTML = `
        <h3>${p.name}</h3>
        <div class="muted">${p.desc}</div>
        <div class="price">${p.price}‚ÇΩ</div>
        <button class="btn" onclick="addToCart('${p.id}')">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
      `;
      el.appendChild(card);
    });
  }

  function updateUI(){
    document.getElementById("cartPill").textContent = `–ö–æ—Ä–∑–∏–Ω–∞: ${cartCount()}`;
    const inCartView = document.getElementById("viewCart").style.display !== "none";
    document.getElementById("mainBtn").textContent = inCartView ? "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑ (–¥–µ–º–æ)" : "–û—Ç–∫—Ä—ã—Ç—å –∫–æ—Ä–∑–∏–Ω—É";

    if (inCartView){
      const { lines, total } = cartSummary();
      const list = lines.length ? lines.map((x,i)=>`
        <div style="display:flex; justify-content:space-between; gap:10px; padding:8px 0; border-bottom:1px solid rgba(255,255,255,.06);">
          <div>${x}</div>
        </div>
      `).join("") : `<div class="muted">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞—è.</div>`;
      document.getElementById("cartList").innerHTML = list;
      document.getElementById("cartTotal").textContent = lines.length ? `–ò—Ç–æ–≥–æ: ${total}‚ÇΩ` : "";
    }
  }

  // 4) –ù–∞–≤–∏–≥–∞—Ü–∏—è
  function goCart(){
    document.getElementById("viewCatalog").style.display="none";
    document.getElementById("viewCart").style.display="block";
    updateUI();
  }
  function goCatalog(){
    document.getElementById("viewCatalog").style.display="block";
    document.getElementById("viewCart").style.display="none";
    updateUI();
  }

  // 5) –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –≤–ª–∞–¥–µ–ª—å—Ü—É –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞:
  // –û—Ç–∫—Ä–æ–µ–º —á–∞—Ç @USERNAME –∏ –ø–æ–¥—Å—Ç–∞–≤–∏–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (deep link).
  // –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ t.me/<username>?text=... (—á–µ—Ä–µ–∑ Telegram).
  // –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ deep links –µ—Å—Ç—å —É Telegram. :contentReference[oaicite:1]{index=1}
  const OWNER_USERNAME = "egorkram"; // <-- –∑–∞–º–µ–Ω–∏—à—å –Ω–∞ –µ—ë @username (–±–µ–∑ @)

  function sendOrder(){
    const c = getCart();
    const { lines, total } = cartSummary();
    if (!lines.length) { alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞—è üòÖ"); return; }

    const name = document.getElementById("name").value.trim() || "‚Äî";
    const phone = document.getElementById("phone").value.trim() || "‚Äî";
    const comment = document.getElementById("comment").value.trim() || "‚Äî";

    const text =
`üõçÔ∏è –ó–∞–∫–∞–∑ (–¥–µ–º–æ)
–ò–º—è: ${name}
–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}

–¢–æ–≤–∞—Ä—ã:
- ${lines.join("\n- ")}

–ò—Ç–æ–≥–æ: ${total}‚ÇΩ
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${comment}`;

    const url = `https://t.me/${OWNER_USERNAME}?text=${encodeURIComponent(text)}`;

    // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –≤–Ω—É—Ç—Ä–∏ Telegram Mini App ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º openTelegramLink, –∏–Ω–∞—á–µ –æ–±—ã—á–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥.
    if (window.Telegram?.WebApp?.openTelegramLink) {
      window.Telegram.WebApp.openTelegramLink(url);
    } else {
      window.open(url, "_blank");
    }
  }

  // init
  renderCatalog();
  updateUI();
</script>
</body>
</html>
